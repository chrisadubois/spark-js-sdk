/*!
 * Copyright (c) 2015-2020 Cisco Systems, Inc. See LICENSE file.
 */

import {StatelessWebexPlugin} from '@webex/webex-core';

import LoggerProxy from '../logs/logger-proxy';
import {
  MEETINGS,
  METRIC_TYPES,
  SDK_ANONYMOUS_ID
} from '../../constants';

import ClientMetricsUtil from './util';

/**
 * @class ClientMetrics
 */
// TODO: This class needs to be refactored to the metrics for centralized usage
export default class ClientMetrics extends StatelessWebexPlugin {
  namespace = MEETINGS;

  submit(key, type, payload = {}) {
    if (!type || !key) {
      // throw error
    }
    if (type === METRIC_TYPES.OPERATIONAL) {
      this.webex.internal.metrics.submitClientMetrics(key, ClientMetricsUtil.transformOperational(payload), SDK_ANONYMOUS_ID);
    }
    else {
      LoggerProxy.logger.error(`ClientMetrics->Not supported metrics submission: ${key}, ${type}: ${JSON.stringify(payload)}`);
    }
  }
}
